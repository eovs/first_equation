mex -setup
% HB=[  
%   0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  43  21  95  -1   -1   -1  -1   -1  -1  -1  -1  -1  -1  -1  57  -1  -1  -1   -1  -1   -1  -1  -1   40   -1  -1  -1  82  -1   -1   -1   -1  -1  -1  -1   -1  -1  -1   -1  -1  -1  32   -1  -1  -1  -1   -1  73  -1
%   0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  61   -1   -1  -1   -1  -1  -1  -1  -1  -1  -1  -1  76  -1  -1   -1  -1   -1  -1  -1   -1   -1  91  -1  -1  63   -1   -1   -1  -1  -1  -1   -1  -1  -1   -1  -1  -1  -1   52  -1  -1  -1   -1  -1  11
%  -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  90  -1  -1   33   -1  -1   -1  -1  -1  -1  -1  -1  -1  -1  -1  55  -1   -1  -1   -1  -1  -1   -1   -1  -1  -1  -1  -1  109   -1   -1  -1  -1  -1   -1  -1  -1   -1  -1  -1  -1   -1  36  -1  -1   -1  -1  -1
%  -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1  107  -1   -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  73   -1  -1   -1  -1  -1   -1   -1  -1  96  -1  -1   -1  109   -1  -1  -1  -1   -1  -1  -1   -1  -1  -1  -1   -1  -1  58  -1   -1  -1  -1
%  -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  96  -1   -1   -1  16   -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1    1  -1   -1  -1  -1   -1   -1  -1  -1  -1  -1   -1   -1    5  -1  -1  -1   -1  -1  -1   -1  -1  -1  -1   -1  -1  -1  21   -1  -1  -1
%  -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  85   -1   -1  -1   41  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1   -1  77   -1  -1  -1   -1   -1  -1  -1  70  -1   -1   -1   -1  97  -1  -1   -1  -1  -1   -1  -1  -1  -1   -1  -1  -1  -1   69  -1  -1
%  -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   49   -1  -1   -1  68  -1  -1  -1  -1  -1  -1  -1  -1  -1   -1  -1  102  -1  -1   -1   -1  -1  -1  -1  11   -1   -1   -1  -1  22  -1   -1  -1  -1   -1  -1  -1  -1   -1  -1  -1  -1   -1  33  -1
%  -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   39  -1   -1  -1  86  -1  -1  -1  -1  -1  -1  -1  -1   -1  -1   -1  77  -1   -1   -1  -1  -1  -1  -1   76   -1   -1  -1  -1   7   -1  -1  -1   -1  -1  -1  -1   -1  -1  -1  -1   -1  -1  10
%  -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   -1  20   -1  -1  -1  52  -1  -1  -1  -1  -1  -1  -1   -1  -1   -1  -1  97   -1   -1  -1  -1  -1  -1   -1   62   -1  -1  -1  -1   70  -1  -1   -1  -1  -1  -1   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   -1  -1   42  -1  -1  -1  15  -1  -1  -1  -1  -1  -1   -1  -1   -1  -1  -1   35   -1  -1  -1  -1  -1   -1   -1   33  -1  -1  -1   -1  84  -1   -1  -1  -1  -1   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   -1  -1   -1   6  -1  -1  -1  10  -1  -1  -1  -1  -1   -1  -1   -1  -1  -1   -1   69  -1  -1  -1  -1   -1   -1   -1  79  -1  -1   -1  -1  54   -1  -1  -1  -1   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1   0  -1  -1  -1   -1   -1  -1   -1  -1  -1  -1  54  -1  -1  -1  -1  -1  -1   -1  -1   72  -1  -1   -1   -1  -1  -1  -1  -1   -1   -1   -1  -1  -1  -1   -1  -1  -1  107  -1  -1  -1   -1  -1   6  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   -1  -1   -1  -1  -1  53  -1  -1  -1  76  -1  -1  -1   -1  -1   -1  -1  -1   -1   -1  -1  90  -1  64   -1   -1   -1  -1  -1  71   -1  -1  -1   -1  60  -1  -1   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  59  -1   -1   -1  -1   -1  -1  -1  -1   4  -1  -1  -1  47  -1  -1   -1  -1   -1  -1  -1   -1   85  -1  -1  -1  -1   10   -1   -1  -1  -1  -1   17  -1  -1   -1  -1  38  -1   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  57   -1   -1  -1   -1  -1  -1  -1  -1  47  -1  -1  -1  83  -1   -1  -1   -1  -1  -1   -1   -1  -1  -1  -1  -1   -1   50   -1  -1  -1  -1   -1  27  -1   -1  -1  -1  77   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1  105   -1  -1   -1  -1  -1  -1  -1  -1  39  -1  -1  -1  48   -1  -1   -1  -1  -1   -1   -1  -1  -1  -1  -1   -1   -1  103  -1  -1  -1   -1  -1  12   -1  -1  -1  -1   38  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   86  -1   -1  -1  -1  -1  -1  -1  -1  90  -1  -1  -1   79  -1   -1  -1  -1   -1   -1  -1  -1  -1  -1   -1   -1   -1  50  -1  -1   -1  -1  -1   51  -1  -1  -1   -1  76  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1 -1  -1  -1  -1  -1   -1   -1  41   -1  -1  -1  -1  -1  -1  -1  -1  19  -1  -1   -1  78   -1  -1  -1   -1   -1  -1  -1  -1  -1   -1   -1   -1  -1   7  -1   -1  -1  -1   -1  47  -1  -1   -1  -1  40  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1 -1  -1  -1  -1  -1   -1   -1  -1  106  -1  -1  -1  -1  -1  -1  -1  -1  81  -1   -1  -1   51  -1  -1   -1   -1  -1  -1  -1  -1   -1   -1   -1  -1  -1  33   -1  -1  -1   -1  -1   7  -1   -1  -1  -1  70   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1 -1  -1  -1  -1  -1   -1   -1  -1   -1   5  -1  -1  -1  -1  -1  -1  -1  -1  97   -1  -1   -1  69  -1   -1   -1  -1  -1  -1  -1   -1   -1   -1  -1  -1  -1  104  -1  -1   -1  -1  -1   6   -1  -1  -1  -1  109  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1 -1  -1  -1  -1  -1   -1   -1  -1   -1  -1  68  -1  -1  -1  -1  -1  -1  -1  -1  101  -1   -1  -1   5   -1   -1  -1  -1  -1  -1   -1   -1   -1  -1  -1  -1   -1  55  -1   -1  -1  -1  -1  103  -1  -1  -1   -1  20  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0 -1  -1  -1  -1  -1   -1   -1  -1   -1  -1  -1   3  -1  -1  -1  -1  -1  -1  -1   -1  38   -1  -1  -1  101   -1  -1  -1  -1  -1   -1   -1   -1  -1  -1  -1   -1  -1  76   -1  -1  -1  -1   -1  10  -1  -1   -1  -1  80
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  0  -1  -1  -1  -1   -1   -1  -1   -1  -1  32  -1  -1  -1  80  -1  -1  -1  -1   -1  -1   -1  -1  -1   -1  106  -1  -1  85  -1   -1   -1   -1  -1  90  -1   -1  -1  -1   31  -1  -1  -1   -1  -1  -1  -1   -1  -1  -1
%  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1  0  43  -1  -1  -1   -1   -1  -1   -1  -1  -1  -1  -1  16  -1  -1  -1  -1  -1   -1  -1   -1  22  -1   -1   -1  55  -1  -1  -1   -1   -1   -1  -1  -1  -1   -1  -1  -1   -1  36  -1  -1   -1  -1  -1  31   -1  -1  -1
% ];
% HC=[ 1  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0 14 10 11 0  0  0 0  0  0  0  0  0 0  0 3  0  0  0  0  0  0  0  0  8  0  0  0  2  0 0 0  0  0  0 0  0 0  0  0  0  0 6  0 0  0  0 0 5  0
%  1 10 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 2  0  0 0  0  0  0  0  0 0  0 0  4  0  0  0  0  0  0  0  0  0  5  0  0  7 0 0  0  0  0 0  0 0  0  0  0  0 0 15 0  0  0 0 0  6
%  0 10 7  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  5  0 0 12  0 0  0  0  0  0  0 0  0 0  0  8  0  0  0  0  0  0  0  0  0  0  0  0 4 0  0  0  0 0  0 0  0  0  0  0 0  0 1  0  0 0 0  0
%  0  0 7 13 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 0  0 15 0  0  0  0  0  0 0  0 0  0  0  5  0  0  0  0  0  0  0  0  3  0  0 0 8  0  0  0 0  0 0  0  0  0  0 0  0 0 10  0 0 0  0
%  0  0 0 13 4  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  7 0  0  0 8  0  0  0  0  0 0  0 0  0  0  0 14  0  0  0  0  0  0  0  0  0  0 0 0  2  0  0 0  0 0  0  0  0  0 0  0 0  0 11 0 0  0
%  0  0 0  0 4 14 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 3  0  0 0  7  0  0  0  0 0  0 0  0  0  0  0  8  0  0  0  0  0  0  0 15  0 0 0  0  5  0 0  0 0  0  0  0  0 0  0 0  0  0 6 0  0
%  0  0 0  0 0 14 6 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 0 10  0 0  0  3  0  0  0 0  0 0  0  0  0  0  0  1  0  0  0  0  0  0  0  8 0 0  0  0  7 0  0 0  0  0  0  0 0  0 0  0  0 0 5  0
%  0  0 0  0 0  0 6 3  0 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 0  0 15 0  0  0  7  0  0 0  0 0  0  0  0  0  0  0 14  0  0  0  0  0  0  0 4 0  0  0  0 2  0 0  0  0  0  0 0  0 0  0  0 0 0  5
%  0  0 0  0 0  0 0 3 12 0 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 0  0  0 5  0  0  0  4  0 0  0 0  0  0  0  0  0  0  0 11  0  0  0  0  0  0 0 1  0  0  0 0 15 0  0  0  0  0 0  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0 12 4 0 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 0  0  0 0 14  0  0  0  8 0  0 0  0  0  0  0  0  0  0  0 10  0  0  0  0  0 0 0 15  0  0 0  0 2  0  0  0  0 0  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 4 1 0 0  0 0 0 0 0  0 0  0 0 0  0  0  0 0  0  0 0  0 12  0  0  0 5  0 0  0  0  0  0  0  0  0  0  0  8  0  0  0  0 0 0  0  6  0 0  0 0 13  0  0  0 0  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 1 7 0  0 0 0 0 0  0 0  0 0 0  3  0  0 0  0  0 0  0  0  0  0  4 0  0 0  0  0  0  0  0 10  0  0  0  0  0  0  0  0 0 0  0  0  0 0  0 0  0 14  0  0 0  0 0  5  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 7 4  0 0 0 0 0  0 0  0 0 0  0  0  0 0  0  0 0  0  0  0 10  0 0  0 3  0  0  0  0  0  0  0  0  0  0  0 12  0  9 0 0  0  0  0 6  0 0  0  0 14  0 0  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 4 12 0 0 0 0  0 0  0 0 0  0  0  9 0  0  0 0  0  0  0  0 13 0  0 0  2  0  0  0  0  0  0  0  0 15  0  0  0  0 1 0  0  0  0 0 11 0  0  0  0 14 0  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0 12 7 0 0 0  0 0  0 0 0  0  0  0 8  0  0 0  0  0  0  0  0 3  0 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0 0 6  0  0  0 0  0 4  0  0  0  0 2  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 7 1 0 0  0 0  0 0 0  0  0  0 0  2  0 0  0  0  0  0  0 0  3 0  0  0 14  0  0  0  0  0  0  0  0  0  0  0 0 0  5  0  0 0  0 0 10  0  0  0 0 11 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 1 8 0  0 0  0 0 0  0  0  0 0  0 15 0  0  0  0  0  0 0  0 7  0  0  0  4  0  0  0  0  0  0  0  0  0  0 0 0  0 13  0 0  0 0  0 10  0  0 0  0 3  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 8 4  0 0  0 0 0  0  0  0 0  0  0 1  0  0  0  0  0 0  0 0 11  0  0  0 15  0  0  0  0  0  0  0  0  0 0 0  0  0  2 0  0 0  0  0  9  0 0  0 0 14  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 4 11 0  0 0 0  0  0  0 0  0  0 0 14  0  0  0  0 0  0 0  0  9  0  0  0  8  0  0  0  0  0  0  0  0 0 0  0  0  0 2  0 0  0  0  0 12 0  0 0  0  7 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0 11 3  0 0 0  0  0  0 0  0  0 0  0  9  0  0  0 0  0 0  0  0 14  0  0  0  4  0  0  0  0  0  0  0 0 0  0  0  0 0  8 0  0  0  0  0 6  0 0  0  0 1 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 3 10 0 0  0  0  0 0  0  0 0  0  0 11  0  0 0  0 0  0  0  0  7  0  0  0  4  0  0  0  0  0  0 0 0  0  0  0 0  0 1  0  0  0  0 0 12 0  0  0 0 5  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 10 7 0  0  0  0 0  0  0 0  0  0  0  5  0 0  0 0  0  0  0  0  3  0  0  0 12  0  0  0  0  0 0 0  0  0  0 0  0 0 15  0  0  0 0  0 2  0  0 0 0  9
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 7 4  0  0  0 0  0  0 0  0  0 11  0  0 0 10 0  0  0  0  0  0  0  0  0  0  8  0  0  6  0 0 0  0  0  9 0  0 0  0  5  0  0 0  0 0  0  0 0 0  0
%  0  0 0  0 0  0 0 0  0 0 0 0 0  0 0 0 0 0  0 0  0 0 4 14  0  0 0  0  0 0  0  0  0  0  0 3  0 0  0  0  0  0  0  0  9  0  0  0 15  0  0  0 0 0  0  0  0 0  0 0  0  0  2  0 0  0 0  0  6 0 0  0
% ];


HB=[  
  0 0 0
  0 1 2
   ];
HC=[ 
  1 1 1
  1 1 2
   ];

M=7;
Q=16;


fprintf('binary code\n');
for g=6:2:16
    [Neqs, HBbad] = check_girth(HB, M, g);
    if( Neqs < 0 || HBbad > 0 )
        fprintf('girth  = %2d, ', g-2); 
        if( Neqs < 0 )
            fprintf('BALANCED_CYCLE\n');
        else
            fprintf('equations: %6d, bad HB: %4d\n', Neqs, HBbad ); 
        end
        break;
    else
       fprintf('girth >= %2d, equations: %6d, bad HB: %4d\n', g, Neqs, HBbad ); 
    end
end

fprintf('non-binary code\n');
for g=6:2:14
    [Neqs, HBbad, HCbad] = check_girth(HB, HC, M, Q, g);
    if( Neqs < 0 || (HBbad > 0 && HCbad > 0 ) )
        fprintf('girth  = %2d, ', g-2); 
        if( Neqs < 0 )
            fprintf('BALANCED_CYCLE\n');
        else
            fprintf('equations: %6d, bad HB: %4d, bad HC: %4d\n', Neqs, HBbad, HCbad ); 
        end
        break;
    else
       fprintf('girth >= %2d, equations: %6d, bad HB: %4d, bad HC: %4d\n', g, Neqs, HBbad, HCbad ); 
    end
end